#!/bin/bash
# SlowDNS Manager - SINNOMBRE22

IP=$(curl -s -4 icanhazip.com)
HOST=$(hostname)

# Colores
RED='\033[1;31m'
GREEN='\033[1;32m'
YELLOW='\033[1;33m'
BLUE='\033[1;34m'
CYAN='\033[1;36m'
WHITE='\033[1;37m'
GRAY='\033[1;37m'
RESET='\033[0m'

slowdns_menu() {

tput reset

echo -e "${GRAY}[${RED}-${GRAY}]${RED} ═══════════════════════════════════════════════ ${RESET}"
figlet -p -f slant SlowDNS
echo -e "${GRAY}[${RED}-${GRAY}]${RED} ═════════════  SINNOMBRE22  ═════════════ ${RESET}"
echo -e "${GRAY}[${RED}-${GRAY}]${RED} ═══════════════════════════════════════════════ ${RESET}"

echo -e "${YELLOW}IP DEL SERVIDOR:${WHITE} $IP"
echo -e "${YELLOW}HOSTNAME:${WHITE} $HOST"

archivo="/etc/slowdns/infons"

if [ -f "$archivo" ]; then
    echo -ne "${YELLOW}TU NS:${WHITE} "
    cat /etc/slowdns/infons
    echo -ne "${YELLOW}CLAVE PÚBLICA:${WHITE} "
    cat /root/server.pub
else
    echo -e "${RED}SLOWDNS NO INSTALADO${RESET}"
fi

echo -e "${GRAY}═══════════════════════════════════════════════${RESET}"
echo -e "${YELLOW}[01]${WHITE} Instalar SlowDNS SSH"
echo -e "${YELLOW}[02]${WHITE} Instalar SlowDNS SSL"
echo -e "${YELLOW}[03]${WHITE} Instalar SlowDNS DROPBEAR"
echo -e "${YELLOW}[04]${WHITE} Instalar SlowDNS SOCKS"
echo -e "${YELLOW}[05]${WHITE} Instalar SlowDNS Servicio Personalizado"
echo -e "${YELLOW}[06]${WHITE} Ver información"
echo -e "${YELLOW}[07]${WHITE} Iniciar SlowDNS"
echo -e "${YELLOW}[08]${WHITE} Reiniciar SlowDNS"
echo -e "${YELLOW}[09]${WHITE} Detener SlowDNS"
echo -e "${YELLOW}[10]${WHITE} Eliminar SlowDNS"
echo -e "${YELLOW}[11]${WHITE} Actualizar / Reinstalar"
echo -e "${YELLOW}[12]${WHITE} Desinstalar Script"
echo -e "${YELLOW}[00]${WHITE} Salir"
echo ""
read -p "Seleccione una opción: " option

case $option in
    1) bash /etc/slowdns/slowdns-ssh ;;
    2) bash /etc/slowdns/slowdns-ssl ;;
    3) bash /etc/slowdns/slowdns-drop ;;
    4) bash /etc/slowdns/slowdns-socks ;;
    5) bash /etc/slowdns/slowdns-customservice ;;
    6) bash /etc/slowdns/slowdns-info ;;
    7) bash /etc/slowdns/startdns ;;
    8) bash /etc/slowdns/restartdns ;;
    9) bash /etc/slowdns/stopdns ;;
    10)
        bash /etc/slowdns/stopdns
        bash /etc/slowdns/remove-slow
        ;;
    11)
        wget -O update https://raw.githubusercontent.com/powermx/dnstt/main/update
        chmod +x update
        bash update
        ;;
    12)
        bash /etc/slowdns/remove-slow
        rm -f /bin/slowdns
        echo -e "${RED}Script eliminado correctamente.${RESET}"
        sleep 2
        exit
        ;;
    0|00)
        exit
        ;;
    *)
        echo -e "${RED}Opción inválida.${RESET}"
        sleep 2
        ;;
esac

echo ""
read -p "Presione ENTER para continuar..."
slowdns_menu
}

slowdns_menu