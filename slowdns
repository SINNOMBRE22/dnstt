#!/bin/bash
# =============================
# SLOWDNS MANAGER - SINNOMBRE22
# =============================

IP=$(curl -s -4 icanhazip.com)
HOST=$(hostname)

# =============================
# COLORES OFICIALES
# =============================
R='\033[0;31m'; G='\033[0;32m'; Y='\033[1;33m'; B='\033[0;34m'
M='\033[0;35m'; C='\033[0;36m'; W='\033[1;37m'; N='\033[0m'
BOLD='\033[1m'
ROJO="\e[31m"; VERDE="\e[32m"; CYAN="\e[36m"; AMARILLO="\e[33m"; BLANCO="\e[97m"; RESET="\e[0m"

LINEA="${ROJO}══════════════════════════ / / / ══════════════════════════${RESET}"

slowdns_menu() {

clear

echo -e "$LINEA"
figlet -p -f slant SlowDNS
echo -e "${BOLD}${BLANCO}                    SINNOMBRE22 MANAGER                    ${RESET}"
echo -e "$LINEA"

echo ""
echo -e "${AMARILLO}IP DEL SERVIDOR:${RESET} $IP"
echo -e "${AMARILLO}HOSTNAME:${RESET} $HOST"
echo ""

archivo="/etc/slowdns/infons"

if [ -f "$archivo" ]; then
    echo -ne "${AMARILLO}TU NS:${RESET} "
    cat /etc/slowdns/infons
    echo -ne "${AMARILLO}CLAVE PÚBLICA:${RESET} "
    cat /root/server.pub
else
    echo -e "${ROJO}SLOWDNS NO INSTALADO${RESET}"
fi

echo ""
echo -e "$LINEA"
echo ""
echo -e "${VERDE}[01]${RESET} ${CYAN}Instalar SlowDNS SSH${RESET}"
echo -e "${VERDE}[02]${RESET} ${CYAN}Instalar SlowDNS SSL${RESET}"
echo -e "${VERDE}[03]${RESET} ${CYAN}Instalar SlowDNS DROPBEAR${RESET}"
echo -e "${VERDE}[04]${RESET} ${CYAN}Instalar SlowDNS SOCKS${RESET}"
echo -e "${VERDE}[05]${RESET} ${CYAN}Instalar SlowDNS Servicio Personalizado${RESET}"
echo -e "${VERDE}[06]${RESET} ${CYAN}Ver información${RESET}"
echo -e "${VERDE}[07]${RESET} ${CYAN}Iniciar SlowDNS${RESET}"
echo -e "${VERDE}[08]${RESET} ${CYAN}Reiniciar SlowDNS${RESET}"
echo -e "${VERDE}[09]${RESET} ${CYAN}Detener SlowDNS${RESET}"
echo -e "${VERDE}[10]${RESET} ${CYAN}Eliminar SlowDNS${RESET}"
echo -e "${VERDE}[11]${RESET} ${CYAN}Actualizar / Reinstalar${RESET}"
echo -e "${VERDE}[12]${RESET} ${CYAN}Desinstalar Script${RESET}"
echo -e "${VERDE}[00]${RESET} ${CYAN}Salir${RESET}"
echo ""

read -p "Seleccione una opción: " option

case $option in
    1) bash /etc/slowdns/slowdns-ssh ;;
    2) bash /etc/slowdns/slowdns-ssl ;;
    3) bash /etc/slowdns/slowdns-drop ;;
    4) bash /etc/slowdns/slowdns-socks ;;
    5) bash /etc/slowdns/slowdns-customservice ;;
    6) bash /etc/slowdns/slowdns-info ;;
    7) bash /etc/slowdns/startdns ;;
    8) bash /etc/slowdns/restartdns ;;
    9) bash /etc/slowdns/stopdns ;;
    10)
        bash /etc/slowdns/stopdns
        bash /etc/slowdns/remove-slow
        ;;
    11)
        wget -O update https://raw.githubusercontent.com/SINNOMBRE22/dnstt/main/update
        chmod +x update
        bash update
        ;;
    12)
        bash /etc/slowdns/remove-slow
        rm -f /bin/slowdns
        echo -e "${ROJO}Script eliminado correctamente.${RESET}"
        sleep 2
        exit
        ;;
    0|00)
        exit
        ;;
    *)
        echo -e "${ROJO}Opción inválida.${RESET}"
        sleep 2
        ;;
esac

echo ""
read -p "Presiona ENTER para continuar..."
slowdns_menu
}

slowdns_menu